<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Plan Details - Zindigi Musafir</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1E3A6D', // Deep Blue
                        'primary-light': '#2A4B8D',
                        'primary-pale': '#E8EDF5',
                        accent: '#26d0ce', // Teal Accent
                    }
                }
            }
        }
    </script>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Custom Styles -->
    <link rel="stylesheet" href="styles.css">
    <style>
        .toggle-checkbox:checked {
            right: 0;
            border-color: #1E3A6D;
        }

        .toggle-checkbox:checked+.toggle-label {
            background-color: #1E3A6D;
        }
    </style>
</head>

<body class="bg-gray-200 font-sans">
    <div class="min-h-screen flex justify-center">
        <!-- Mobile Frame -->
        <div class="w-full max-w-md bg-white min-h-screen shadow-2xl relative overflow-hidden flex flex-col">

            <!-- Main Content Area -->
            <main id="app" class="flex-1 overflow-y-auto no-scrollbar bg-white pb-20">
                <div class="bg-white">
                    <!-- Header -->
                    <div class="px-3 border-b border-gray-100 pb-2 pt-2">
                        <div class="flex justify-between items-center">
                            <h1 class="text-md font-bold text-primary">My Umrah Journey</h1>
                            <div class="flex space-x-3">
                                <button
                                    class="w-10 h-10 rounded-full border border-gray-200 flex items-center justify-center text-primary hover:bg-gray-50">
                                    <i data-lucide="bell" color="black" width="20"></i>
                                </button>
                                <button id="menu-btn"
                                    class="w-10 h-10 rounded-full border border-gray-200 flex items-center justify-center text-[#627497] hover:bg-gray-50">
                                    <i data-lucide="menu" width="20"></i>
                                </button>
                            </div>
                        </div>

                        <div class="flex justify-between bg-[#F4F8FB] p-1 rounded-full mt-4 mb-3 shadow-sm ">
                            <a href="plans.html"
                                class="px-4 py-1 rounded-full text-xs font-bold transition-all text-gray-500 hover:bg-gray-50 flex items-center">Overview</a>
                            <button
                                class="px-4 py-1 rounded-full text-xs font-bold transition-all bg-primary text-white shadow-md">My
                                Umrah 2025</button>
                            <button
                                class="px-4 py-1 rounded-full text-xs font-bold transition-all text-gray-500 hover:bg-gray-50">Parent's
                                Umrah</button>
                            <!-- Link to Create Plan -->
                            <a href="journeyForm.html"
                                class="flex items-center justify-center bg-[#E5EDF3] px-3 ml-3 py-1 rounded-full transition-all">
                                <i data-lucide="plus" color="#1E3A6D" width="12"></i>
                            </a>
                        </div>
                    </div>

                    <!-- Plan Details Content -->
                    <div class="mb-4 p-5 rounded-lg min-h-screen flex flex-col">
                        <div class="flex justify-between items-center mb-3">
                            <h2 class="font-bold text-[#1E3A6D] text-sm">Family Umrah 2025</h2>
                        </div>

                        <div class="flex justify-between bg-[#F4F8FB] rounded-xl p-4 mb-6">
                            <div>
                                <p class="text-[#627497] text-sm mb-1">Total Saved</p>
                                <p class="font-bold text-sm text-[#1E3A6D]">PKR 95,000</p>
                            </div>
                            <div class="text-right">
                                <p class="text-[#627497] text-sm mb-1">Required Amount</p>
                                <p class="font-bold text-sm text-[#1E3A6D]">PKR 200,000</p>
                            </div>
                        </div>

                        <div class="bg-[#F4F8FB] p-4 rounded-xl mb-6">
                            <div class="flex justify-between items-center mb-4">
                                <div class="flex items-center space-x-3">
                                    <img src="assets/svgs/fast.svg" alt="Progress" class="w-10 h-10"
                                        onerror="this.src='https://placehold.co/64x64?text=Progress'">
                                    <div>
                                        <h3 class="font-bold text-sm text-[#1E3A6D] m-0">Pay early & save 2% instantly!
                                        </h3>
                                        <span class="text-xs text-[#627497]">Unlock 2x Rewards & Priority</span>
                                    </div>
                                </div>
                                <img src="assets/svgs/ArrowRight.svg" alt="Rewards" class="w-5 h-5"
                                    onerror="this.src='https://placehold.co/64x64?text=Rewards'">
                            </div>
                            <div class="flex justify-between items-center mb-3">
                                <div>
                                    <p class="text-[#627497] text-sm font-semibold mb-1">Upcoming payment</p>
                                    <p class="text-[#1E3A6D] font-bold text-md">PKR 25,000</p>
                                </div>
                                <div class="flex flex-col justify-center items-end text-right">
                                    <div
                                        class="h-min text-[9px] text-right rounded-md text-[#DC6E2A] bg-[#FFEADC] px-1 py-0 flex justify-end items-center gap-1">
                                        <i data-lucide="clock" color="#DC6E2A" width="10"></i> Due 11/11/2025
                                    </div>
                                    <button onclick="openEditScheduleModal()"
                                        class="mt-2 bg-[#F1FDFA] border border-[#24B3BA] rounded-xl py-1 px-3 text-xs font-semibold text-[#24B3BA] hover:bg-gray-50">Edit
                                        Schedule</button>
                                </div>
                            </div>
                            <div class="flex justify-between space-x-2 pt-4">
                                <button
                                    class="bg-transparent border border-[#DFE8EE] rounded-xl py-3 px-6 text-xs font-semibold text-[#1E3A6D] hover:bg-gray-50">Skip
                                    Month</button>
                                <button onclick="openManageInstallmentModal()"
                                    class="bg-[#E7EDF1] border border-[#DFE8EE] rounded-xl py-3 px-6 text-xs font-semibold text-[#1E3A6D] hover:bg-gray-50">Merge
                                    & Pay</button>
                                <button onclick="openPayNowModal()"
                                    class="bg-primary text-white rounded-xl py-3 px-6 font-semibold text-xs hover:bg-[#16315b]">Pay
                                    Now</button>
                            </div>
                        </div>

                        <div>
                            <h3 class="font-bold text-[#1E3A6D] mb-4">Transaction History</h3>
                            <!-- Transaction 1 -->
                            <div class="flex justify-between items-start">
                                <div class="w-5 -translate-y-3">
                                    <img src="assets/svgs/check.svg" alt="check" class="translate-y-12 w-3 h-3">
                                    <div class="border-l-2 border-dashed  h-20 ml-1"></div>
                                </div>
                                <div class="w-96 mb-4 p-4 rounded-xl bg-[#F4F8FB] shadow-sm">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <p class="font-semibold text-sm text-[#1E3A6D] mb-1">Initial Deposit</p>
                                            <p class="text-[#627497] text-xs ">2024-01-15</p>
                                        </div>
                                        <div>
                                            <div
                                                class="w-100 text-xs text-right flex flex-col items-end justify-end gap-2">
                                                <div
                                                    class="mb-1 text-[9px] flex items-center justify-end gap-2 px-1 text-[#41AB13] bg-[#E6FBDE] font-semibold">
                                                    <i data-lucide="check" color="#41AB13" width="10"></i>Paid
                                                </div>
                                            </div>
                                            <p class="font-bold text-xs text-right text-[#24B3BA]">PKR 50,000</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Transaction 2 -->
                            <div class="flex justify-between items-start">
                                <div class="w-5 -translate-y-3">
                                    <img src="assets/svgs/check.svg" alt="check" class="translate-y-12 w-3 h-3">
                                    <div class="border-l-2 border-dashed h-20 ml-1"></div>
                                </div>
                                <div class="w-96 mb-4 p-4 rounded-xl bg-[#F4F8FB] shadow-sm">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <p class="font-semibold text-sm text-[#1E3A6D] mb-1">January</p>
                                            <p class="text-[#627497] text-xs ">2024-02-15</p>
                                        </div>
                                        <div>
                                            <div
                                                class="w-100 text-xs text-right flex flex-col items-end justify-end gap-2">
                                                <div
                                                    class="text-[9px] flex mb-1 items-center justify-end gap-2 px-1 text-[#41AB13] bg-[#E6FBDE] font-semibold">
                                                    <i data-lucide="check" color="#41AB13" width="10"></i>Paid
                                                </div>
                                            </div>
                                            <p class="font-bold text-xs text-right text-[#24B3BA]">PKR 45,000</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex justify-between items-start">
                                <div class="w-5 -translate-y-3">
                                    <img src="assets/svgs/check.svg" alt="check" class="translate-y-12 w-3 h-3">
                                    <div class="border-l-2 border-dashed h-20 ml-1"></div>
                                </div>
                                <div class="w-96 mb-4 p-4 rounded-xl bg-[#F4F8FB] shadow-sm">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <p class="font-semibold text-sm text-[#1E3A6D] mb-1">February</p>
                                            <p class="text-[#627497] text-xs ">2024-02-15</p>
                                        </div>
                                        <div>
                                            <div
                                                class="w-100 text-xs text-right flex flex-col items-end justify-end gap-2 ">
                                                <div
                                                    class="text-[9px] w-max mb-1 flex items-center justify-end gap-2 px-1 text-[#41AB13] bg-[#E6FBDE] font-semibold">
                                                    <i data-lucide="check" color="#41AB13" width="10"></i>Paid
                                                </div>
                                            </div>
                                            <p class="font-bold text-xs text-right text-[#24B3BA]">PKR 45,000</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- Side Menu Overlay -->
            <div id="side-menu-overlay"
                class="fixed inset-0 bg-black/20 z-40 hidden opacity-0 transition-opacity duration-300"></div>

            <!-- Side Menu Drawer -->
            <div id="side-menu"
                class="absolute top-0 bottom-0 right-0 z-50 transform translate-x-full transition-transform duration-300 ease-in-out bg-white w-3/4 h-full">
                <!-- Inner Container -->
                <div class="flex flex-col h-full relative">
                    <!-- Close Button -->
                    <button id="menu-close-btn"
                        class="absolute top-8 right-5 text-gray-800 p-2 hover:bg-gray-100 rounded-full">
                        <i data-lucide="x" width="24"></i>
                    </button>

                    <!-- Menu Content -->
                    <div class="mt-24 px-3 space-y-3">
                        <a href="profile.html"
                            class="flex items-center space-x-3 px-4 py-4 text-gray-500 hover:bg-gray-50 rounded-xl transition-colors">
                            <i data-lucide="user" width="20"></i>
                            <span class="font-medium">Profile & Settings</span>
                        </a>

                        <a href="support.html"
                            class="flex items-center space-x-3 px-4 py-4 text-gray-500 hover:bg-gray-50 rounded-xl transition-colors">
                            <i data-lucide="help-circle" width="20"></i>
                            <span class="font-medium">Support</span>
                        </a>

                        <a href="terms-and-conditions.html"
                            class="flex items-center space-x-3 px-4 py-4 text-gray-500 hover:bg-gray-50 rounded-xl transition-colors">
                            <i data-lucide="file-text" width="20"></i>
                            <span class="font-medium">Terms & Conditions</span>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Bottom Navigation -->
            <nav id="bottom-nav"
                class="fixed bottom-0 left-0 right-0 bg-primary text-white pb-safe pt-2 px-4 z-50 max-w-md mx-auto rounded-t-2xl shadow-2xl">
                <div class="flex justify-between items-center pb-4 pt-2">
                    <a href="index.html"
                        class="flex flex-col items-center space-y-1.5 transition-all duration-300 w-1/4 text-blue-200"
                        style="color: #bfdbfe;">
                        <div class="transition-all duration-300">
                            <i data-lucide="home" width="22" stroke-width="2"></i>
                        </div>
                        <span class="text-[9px] font-medium tracking-wide opacity-70">Home</span>
                    </a>
                    <a href="journey.html"
                        class="flex flex-col items-center space-y-1.5 transition-all duration-300 w-1/4 text-blue-200"
                        style="color: #bfdbfe;">
                        <div class="transition-all duration-300">
                            <img src="assets/svgs/Line.svg" class="w-4" />

                        </div>
                        <span class="text-[9px] font-medium tracking-wide opacity-70">Ihram</span>
                    </a>
                    <!-- Active -->
                    <button class="flex flex-col items-center space-y-1.5 transition-all duration-300 w-1/4 text-accent"
                        style="color: #26d0ce;">
                        <div class="transition-all duration-300 -translate-y-1">
                            <i data-lucide="calendar" width="22" stroke-width="2"></i>
                        </div>
                        <span class="text-[9px] font-medium tracking-wide opacity-100">Umrah</span>
                    </button>
                    <a href="points.html"
                        class="flex flex-col items-center space-y-1.5 transition-all duration-300 w-1/4 text-blue-200"
                        style="color: #bfdbfe;">
                        <div class="transition-all duration-300">
                            <i data-lucide="trophy" width="22" stroke-width="2"></i>
                        </div>
                        <span class="text-[9px] font-medium tracking-wide opacity-70">Rewards</span>
                    </a>
                </div>
            </nav>

            <!-- Edit Schedule Modal -->
            <div id="edit-schedule-modal"
                class="fixed p-5 inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 hidden">
                <div class="p-5 flex justify-center ">
                    <div class="bg-white no-scrollbar h-[500px] overflow-y-scroll p-5 rounded-lg shadow-lg max-w-sm">
                        <div class="flex items-start justify-between">
                            <div>
                                <h2 class="font-bold text-sm text-[#1E3A6D] ">Change Installment Amount</h2>
                                <p class="text-[#627497] text-xs mb-4">Enter the amount you want to pay for this monthâ€™s
                                    installment.</p>
                            </div>
                            <button onclick="closeEditScheduleModal()" class="ml-auto block">
                                <i data-lucide="x" color="#1E3A6D"></i>
                            </button>
                        </div>

                        <input type="number" id="installment-input" placeholder="e.g. PKR 25,000"
                            class="w-full border border-gray-300 rounded-xl px-3 py-2 mb-4" />

                        <div id="installment-list">
                            <!-- Injected via script -->
                        </div>

                        <p class="lucky-draw text-xs text-primary  px-2 py-1 rounded mt-3">
                            <strong>Note:</strong> Changing your installment amount may affect your overall plan and
                            could delay your expected Umrah month. Weâ€™ll update your schedule based on your new
                            payment..
                        </p>

                        <div class="flex justify-between gap-2 pt-4">
                            <button onclick="closeEditScheduleModal() "
                                class="w-3/6 text-primary rounded-lg bg-white border border-[#DFE8EE] text-[#1E3A6D]">Back</button>
                            <button onclick="closeEditScheduleModal()"
                                class="w-3/6 bg-primary text-white px-3 py-2 rounded-lg"
                                style="background-color: #1E3A6D;">Update Amount</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pay Now Modal -->
            <div id="pay-now-modal"
                class="fixed inset-0 bg-black bg-opacity-40 hidden flex items-center justify-center z-50">
                <div class="p-5 w-full flex justify-center">
                    <div class="bg-white rounded-lg p-5 w-full max-w-sm shadow-2xl relative">
                        <!-- Header -->
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-bold text-sm text-[#1E3A6D]">Confirm Installment Payment</h3>
                            </div>
                            <button onclick="closePayNowModal()"><i data-lucide="x" class="text-gray-400"></i></button>
                        </div>
                        <!-- Content -->
                        <div class="space-y-2">
                            <div class="flex justify-between items-center bg-[#F4F8FB] p-3 rounded-lg">
                                <span class="text-[#627497] text-sm">Monthly Installment:</span>
                                <span class="font-bold text-sm text-[#1E3A6D]">PKR 25,000</span>
                            </div>
                            <div class="flex justify-between items-center lucky-draw p-3 rounded-lg">
                                <div class="flex items-center gap-2">
                                    <span class="">ðŸ‘‘</span>
                                    <div>
                                        <p class="text-sm font-semibold text-[#1E3A6D]">Use Ihram Points</p>
                                        <p class="text-xs text-[#627497]">Available: 1249</p>
                                    </div>
                                </div>

                                <!-- Toggle Switch -->
                                <div
                                    class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" name="toggle" id="toggle"
                                        class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer border-[#b5bdc4]" />
                                    <label for="toggle"
                                        class="toggle-label block overflow-hidden h-5 rounded-full bg-[#b5bdc4] cursor-pointer"></label>
                                </div>
                            </div>

                            <hr class="border-gray-100" />

                            <div class="flex justify-between items-center mb-3">
                                <span class="font-semibold text-[#1E3A6D]">Total Amount:</span>
                                <span class="text-xl font-bold text-[#24B3BA]">PKR 25,000</span>
                            </div>
                        </div>
                        <!-- Button -->
                        <button onclick="proceedToOTP()"
                            class="w-full bg-[#1E3A6D] text-white py-3.5 rounded-xl font-bold hover:bg-[#16315b] transition mt-3">Pay
                            Securely</button>
                    </div>
                </div>
            </div>

            <!-- Merge Installments Modal -->
            <div id="manage-installment-modal"
                class="fixed inset-0 bg-black bg-opacity-40 hidden flex items-center justify-center z-50">
                <div class="px-3 w-full flex justify-center">
                    <div
                        class="bg-white rounded-2xl p-4 relative w-full max-w-sm shadow-2xl transition-all duration-300">
                        <!-- Close Icon -->
                        <button onclick="closeManageInstallmentModal()"
                            class="absolute top-6 right-6 text-gray-400 hover:text-gray-600 transition-colors">
                            <i data-lucide="x" width="20"></i>
                        </button>

                        <!-- Header -->
                        <div class="mb-2">
                            <h2 class="text-sm font-bold text-[#1E3A6D]">Merge Installments</h2>
                        </div>
                        <p class="text-xs text-[#627497] mb-6 leading-relaxed">
                            Selected upcoming installments will be merged into one payment, and your plan will be
                            updated.
                        </p>

                        <div class="bg-[#F8FAFC] rounded-2xl p-3 mb-6">
                            <!-- List Header -->
                            <div class="flex justify-between items-center mb-4">
                                <span class="text-xs font-semibold text-[#627497]">Upcoming Months</span>
                                <button onclick="togglePayAllRemaining()"
                                    class="text-xs font-bold text-[#24B3BA] hover:underline transition-all">Pay All
                                    Remaining</button>
                            </div>

                            <!-- Installment List -->
                            <div class="space-y-2 mb-4 max-h-[220px] overflow-y-auto no-scrollbar pr-1">
                                <!-- Month 1 -->
                                <div onclick="toggleInstallment(this)"
                                    class="installment-row border border-[#DFE8EE] rounded-xl p-3 flex items-center justify-between cursor-pointer transition-all hover:border-[#24B3BA]"
                                    data-amount="5000">
                                    <div class="flex items-center gap-3">
                                        <div
                                            class="checkbox-wrapper w-4 h-4 rounded-full border-2 border-gray-200 flex items-center justify-center transition-all">
                                            <i data-lucide="check" class="text-white" width="12"></i>
                                        </div>
                                        <div>
                                            <p class="text-xs font-bold text-[#1E3A6D]">January 2026</p>
                                            <p class="text-[10px] text-[#627497]">Month 1</p>
                                        </div>
                                    </div>
                                    <p class="text-xs font-bold text-[#1E3A6D]">5,000</p>
                                </div>

                                <!-- Month 2 -->
                                <div onclick="toggleInstallment(this)"
                                    class="installment-row border border-[#DFE8EE] rounded-xl p-3 flex items-center justify-between cursor-pointer transition-all hover:border-[#24B3BA]"
                                    data-amount="5000">
                                    <div class="flex items-center gap-3">
                                        <div
                                            class="checkbox-wrapper w-4 h-4 rounded-full border-2 border-gray-200 flex items-center justify-center transition-all">
                                            <i data-lucide="check" class="text-white" width="12"></i>
                                        </div>
                                        <div>
                                            <p class="text-xs font-bold text-[#1E3A6D]">February 2026</p>
                                            <p class="text-[10px] text-[#627497]">Month 1</p>
                                        </div>
                                    </div>
                                    <p class="text-xs font-bold text-[#1E3A6D]">5,000</p>
                                </div>

                                <!-- Month 3 -->
                                <div onclick="toggleInstallment(this)"
                                    class="installment-row border border-[#DFE8EE] rounded-xl p-3 flex items-center justify-between cursor-pointer transition-all hover:border-[#24B3BA]"
                                    data-amount="5000">
                                    <div class="flex items-center gap-3">
                                        <div
                                            class="checkbox-wrapper w-4 h-4 rounded-full border-2 border-gray-200 flex items-center justify-center transition-all">
                                            <i data-lucide="check" class="text-white" width="12"></i>
                                        </div>
                                        <div>
                                            <p class="text-xs font-bold text-[#1E3A6D]">March 2026</p>
                                            <p class="text-[10px] text-[#627497]">Month 1</p>
                                        </div>
                                    </div>
                                    <p class="text-xs font-bold text-[#1E3A6D]">5,000</p>
                                </div>
                                <div onclick="toggleInstallment(this)"
                                    class="installment-row border border-[#DFE8EE] rounded-lg p-2 flex items-center justify-between cursor-pointer transition-all hover:border-[#DFE8EE] "
                                    data-amount="5000">
                                    <div class="flex items-center gap-3">
                                        <div
                                            class="checkbox-wrapper w-4 h-4 rounded-full border-2 border-gray-200 flex items-center justify-center transition-all">
                                            <i data-lucide="check" class="text-white" width="12"></i>
                                        </div>
                                        <div>
                                            <p class="text-xs font-bold text-[#1E3A6D]">April 2026</p>
                                            <p class="text-[10px] text-[#627497]">Month 1</p>
                                        </div>
                                    </div>
                                    <p class="text-xs font-bold text-[#1E3A6D]">5,000</p>
                                </div>
                            </div>

                            <!-- Summary -->
                            <div class="flex justify-between items-center pt-2 border-t border-gray-100">
                                <span class="text-xs font-bold text-[#1E3A6D]">Total merged amount:</span>
                                <span id="merged-total-display" class="text-md font-bold text-[#24B3BA]">PKR
                                    15,000</span>
                            </div>
                        </div>

                        <!-- Info Note -->
                        <div class="lucky-draw border border-[#D1FAE5] rounded-xl p-3 mb-6">
                            <p class="text-[10px] text-[#065F46] leading-relaxed">
                                <span class="font-bold">Note:</span> The payment schedule and future installments will
                                automatically adjust after this payment is confirmed.
                            </p>
                        </div>

                        <!-- Buttons Row -->
                        <div class="flex gap-3">
                            <button onclick="closeManageInstallmentModal()"
                                class="flex-1 border border-gray-200 text-[#627497] py-3 rounded-xl font-bold text-sm hover:bg-gray-50 transition">
                                Cancel
                            </button>
                            <button onclick="proceedToOTP()"
                                class="flex-1 bg-[#1E3A6D] text-white py-3 rounded-xl font-bold text-sm hover:bg-[#16315b] transition shadow-lg shadow-blue-900/20">
                                Pay Securely
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <style>
                .installment-row.selected {
                    background-color: #E7EDF1;
                    border-color: #24B3BA;
                }

                .installment-row.selected .checkbox-wrapper {
                    background-color: #24B3BA;
                    border-color: #24B3BA;
                }

                .installment-row.selected i {
                    display: block;
                    color: white;
                }
            </style>

            <!-- OTP Verification Modal -->
            <div id="otp-modal"
                class="fixed inset-0 bg-black bg-opacity-40 hidden flex items-center justify-center z-50">
                <div class="px-5 w-full flex justify-center">
                    <div class="bg-white rounded-2xl p-6 relative w-full max-w-sm shadow-2xl">
                        <!-- Header -->
                        <div class="flex justify-between items-start mb-6">
                            <button onclick="backToMergeModal()"
                                class="text-primary hover:bg-gray-100 p-1 rounded-full transition-colors">
                                <i data-lucide="chevron-left" width="24"></i>
                            </button>
                            <h3 class="text-lg font-bold text-[#1E3A6D] pr-8">OTP Verification</h3>
                            <div class="w-8"></div>
                        </div>

                        <div class="text-center">
                            <h4 class="font-bold text-[#1E3A6D] mb-2">Enter Verification Code</h4>
                            <p class="text-xs text-[#627497] mb-8 px-4">
                                A 4-digit code has been sent to your mobile number. Enter it below to confirm your
                                payment.
                            </p>

                            <!-- OTP Inputs -->
                            <div class="flex justify-center gap-3 mb-8">
                                <input type="text" maxlength="1"
                                    class="w-12 h-14 bg-[#F4F8FB] text-primary text-center rounded-xl text-xl font-bold focus:outline-none focus:ring-2 focus:ring-[#1E3A6D] border border-transparent shadow-sm" />
                                <input type="text" maxlength="1"
                                    class="w-12 h-14 bg-[#F4F8FB] text-primary text-center rounded-xl text-xl font-bold focus:outline-none focus:ring-2 focus:ring-[#1E3A6D] border border-transparent shadow-sm" />
                                <input type="text" maxlength="1"
                                    class="w-12 h-14 bg-[#F4F8FB] text-primary text-center rounded-xl text-xl font-bold focus:outline-none focus:ring-2 focus:ring-[#1E3A6D] border border-transparent shadow-sm" />
                                <input type="text" maxlength="1"
                                    class="w-12 h-14 bg-[#F4F8FB] text-primary text-center rounded-xl text-xl font-bold focus:outline-none focus:ring-2 focus:ring-[#1E3A6D] border border-transparent shadow-sm" />
                            </div>

                            <button onclick="confirmPayment()"
                                class="w-full bg-[#1E3A6D] text-white py-3.5 rounded-xl font-bold hover:bg-[#16315b] transition shadow-lg shadow-blue-900/20 mb-4">
                                Confirm
                            </button>

                            <p class="text-xs text-[#627497]">Resend Code in <span
                                    class="text-primary font-bold">30s</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Success Modal -->
            <div id="success-modal"
                class="fixed inset-0 bg-black bg-opacity-40 hidden flex items-center justify-center z-50">
                <div class="px-5 w-full flex justify-center">
                    <div class="bg-white rounded-2xl p-8 relative w-full max-w-sm shadow-2xl text-center">
                        <div
                            class="w-16 h-16 bg-[#F0FDF4] rounded-full flex items-center justify-center mx-auto mb-4 border border-[#DCFCE7]">
                            <img src="assets/svgs/success.svg" alt="Success" class="w-8 h-8"
                                onerror="this.src='https://placehold.co/64x64?text=âœ“'">
                        </div>

                        <h3 class="text-xl font-bold text-[#1E3A6D] mb-2">Payment Successful!</h3>
                        <p class="text-sm text-[#627497] mb-8 leading-relaxed">
                            Your payment of PKR 10,000 has been received. Two installments have been merged into your
                            plan.
                        </p>

                        <button onclick="closeAllModals()"
                            class="w-full bg-[#1E3A6D] text-white py-3.5 rounded-xl font-bold hover:bg-[#16315b] transition shadow-lg shadow-blue-900/20">
                            Done
                        </button>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // Sample Installments Data
        const installments = [
            { id: 1, date: "2024-09-01", amount: 5000, status: "paid", month: "January" },
            { id: 2, date: "2024-10-01", amount: 5000, status: "unpaid", month: "February" },
            { id: 3, date: "2024-11-01", amount: 5000, status: "unpaid", month: "March" }
        ];

        function openEditScheduleModal() {
            renderInstallments();
            document.getElementById("edit-schedule-modal").classList.remove("hidden");
        }

        function closeEditScheduleModal() {
            document.getElementById("edit-schedule-modal").classList.add("hidden");
        }

        function openPayNowModal() {
            document.getElementById("pay-now-modal").classList.remove("hidden");
        }

        function closePayNowModal() {
            document.getElementById("pay-now-modal").classList.add("hidden");
        }

        function openManageInstallmentModal() {
            document.getElementById("manage-installment-modal").classList.remove("hidden");
            // Reset state
            const rows = document.querySelectorAll('.installment-row');
            rows.forEach(r => r.classList.remove('selected'));
            updateMergedTotal();
        }

        function toggleInstallment(element) {
            lucide.createIcons();
            element.classList.toggle('selected');
            updateMergedTotal();
        }

        function togglePayAllRemaining() {
            const rows = document.querySelectorAll('.installment-row');
            const allSelected = Array.from(rows).every(r => r.classList.contains('selected'));

            rows.forEach(r => {
                if (allSelected) {
                    r.classList.remove('selected');
                } else {
                    r.classList.add('selected');
                    lucide.createIcons();
                }
            });
            updateMergedTotal();
        }

        function updateMergedTotal() {
            const selectedRows = document.querySelectorAll('.installment-row.selected');
            let total = 0;
            selectedRows.forEach(row => {
                total += parseInt(row.dataset.amount);
            });

            document.getElementById('merged-total-display').innerText = `PKR ${total.toLocaleString()}`;
        }

        function closeManageInstallmentModal() {
            document.getElementById("manage-installment-modal").classList.add("hidden");
        }

        function proceedToOTP() {
            closeManageInstallmentModal();
            setTimeout(() => {
                document.getElementById("otp-modal").classList.remove("hidden");
            }, 100);
        }

        function backToMergeModal() {
            document.getElementById("otp-modal").classList.add("hidden");
            setTimeout(() => {
                openManageInstallmentModal();
            }, 100);
        }

        function confirmPayment() {
            document.getElementById("otp-modal").classList.add("hidden");
            setTimeout(() => {
                document.getElementById("success-modal").classList.remove("hidden");
            }, 100);
        }

        function closeAllModals() {
            document.getElementById("manage-installment-modal").classList.add("hidden");
            document.getElementById("otp-modal").classList.add("hidden");
            document.getElementById("success-modal").classList.add("hidden");
            document.getElementById("pay-now-modal").classList.add("hidden");
            document.getElementById("edit-schedule-modal").classList.add("hidden");
        }

        function renderInstallments() {
            const container = document.getElementById("installment-list");
            container.innerHTML = installments.map((i, index) => `
                <div class=" mb-4 p-4 rounded-xl bg-[#F4F8FB] shadow-sm">
                    <div class="flex justify-between mb-2 items-center">
                        <div>
                            <p class="font-semibold text-sm text-[#1E3A6D]">${i.month}</p>
                            <p class="text-[#627497] text-xs mb-3">${i.date}</p>
                        </div>

                        <div>
                            <p class="text-xs text-right flex items-center gap-2 w-max px-2 rounded-md" style="color: ${i.status === 'paid' ? '#41AB13' : '#E26F31'}; background-color: ${i.status === 'paid' ? '#E6FBDE' : '#F7EADB'};" ><i data-lucide="${i.status === 'paid' ? 'check' : 'clock'}" color="${i.status === 'paid' ? '#41AB13' : '#E26F31'}" width="10"></i>${i.status === 'paid' ? 'Paid' : 'Pending'}</p>
                            <p class="font-bold text-sm text-right text-[#24B3BA]">PKR ${i.amount.toLocaleString()}</p>
                        </div>

                    </div>
                    <div class="flex justify-between items-center mt-2" style="display: ${i.status === 'paid' ? 'none' : 'flex'};">
                        <div class="flex justify-between space-x-1 pt-4 w-full">
                            <button class="bg-transparent border border-[#DFE8EE] rounded-xl py-2 px-4 text-xs font-semibold text-[#1E3A6D] hover:bg-gray-50 flex-1">Skip Month</button>
                            <button onclick="openManageInstallmentModal()" class="bg-[#E7EDF1] border border-[#DFE8EE] rounded-xl py-2 px-4 text-xs font-semibold text-[#1E3A6D] hover:bg-gray-50 flex-1">Merge & Pay</button>
                            <button onclick="openPayNowModal()" class="bg-primary text-white rounded-xl py-2 px-4 font-semibold text-xs hover:bg-[#16315b] flex-1">Pay Now</button>
                        </div>
                    </div>
                </div>
            `).join('');
            lucide.createIcons(); // Re-render icons for injected content
        }

        lucide.createIcons();
    </script>
</body>

</html>